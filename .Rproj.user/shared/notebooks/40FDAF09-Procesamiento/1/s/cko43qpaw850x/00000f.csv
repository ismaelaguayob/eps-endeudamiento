"0",""
"0","columna_folio <- ""folio_n20"""
"0",""
"0","unir_modulos_por_folio <- function(lista_df, col_folio) {"
"0","  # Verificar que la columna folio exista en todos los dataframes de la lista"
"0","  for (i in seq_along(lista_df)) {"
"0","    df_actual <- lista_df[[i]]"
"0","    nombre_df_original <- deparse(substitute(lista_df)) # Intenta obtener el nombre, puede ser genérico"
"0","    if (!col_folio %in% names(df_actual)) {"
"0","      stop(paste0(""Error: La columna folio '"", col_folio, "
"0","                  ""' NO se encuentra en el dataframe #"", i, "
"0","                  "" de la lista (nombres de columna: "", paste(head(names(df_actual), 5), collapse="", ""), ""...). "","
"0","                  ""Asegúrate de que '"", col_folio, ""' exista y tenga el mismo nombre en todos los módulos.""))"
"0","    }"
"0","  }"
"0","  "
"0","  Reduce(function(df1, df2) {"
"0","    full_join(df1, df2, by = col_folio)"
"0","  }, lista_df)"
"0","}"
"0",""
"0","lista_dataframes_2020 <- list(modulo_a_2020, modulo_c_2020, modulo_d_2020)"
"0","datos_2020_consolidados <- unir_modulos_por_folio(lista_dataframes_2020, columna_folio)"
"0","cat(""Dimensiones de datos consolidados 2020 (raw):"", dim(datos_2020_consolidados), ""\n"")"
"1","Dimensiones de datos consolidados 2020 (raw):"
"1"," "
"1","7800"
"1"," "
"1","373"
"1"," "
"1","
"
"0","cat(""Folios únicos en 2020 consolidados:"", n_distinct(datos_2020_consolidados[[columna_folio]]), ""\n"")"
"1","Folios únicos en 2020 consolidados:"
"1"," "
"1","7800"
"1"," "
"1","
"
"0","lista_dataframes_2024 <- list(modulo_a_2024, modulo_c_2024, modulo_d_2024)"
"0","datos_2024_consolidados <- unir_modulos_por_folio(lista_dataframes_2024, columna_folio)"
"0","cat(""Dimensiones de datos consolidados 2024 (raw):"", dim(datos_2024_consolidados), ""\n"")"
"1","Dimensiones de datos consolidados 2024 (raw):"
"1"," "
"1","15788"
"1"," "
"1","286"
"1"," "
"1","
"
"0","cat(""Folios únicos en 2024 consolidados:"", n_distinct(datos_2024_consolidados[[columna_folio]]), ""\n"")"
"1","Folios únicos en 2024 consolidados:"
"1"," "
"1","15788"
"1"," "
"1","
"
"0","# Creamos columna año para cada ola"
"0",""
"0","datos_2020_con_año <- datos_2020_consolidados %>% mutate(año = 2020)"
"0","datos_2024_con_año <- datos_2024_consolidados %>% mutate(año = 2024)"
"0",""
"0",""
